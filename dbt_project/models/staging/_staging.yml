version: 2

models:
  - name: stg_stocks
    description: "Cleaned and validated stock price data from Yahoo Finance"
    columns:
      - name: ticker
        description: "Stock ticker symbol (e.g., PETR4.SA)"
        tests:
          - not_null

      - name: date
        description: "Trading date"
        tests:
          - not_null

      - name: open_price
        description: "Opening price (cleaned)"

      - name: high_price
        description: "Highest price (cleaned)"

      - name: low_price
        description: "Lowest price (cleaned)"

      - name: close_price
        description: "Closing price (cleaned, validated positive)"
        tests:
          - not_null

      - name: volume
        description: "Trading volume (non-negative)"

      - name: adj_close
        description: "Adjusted closing price for returns calculation"

      - name: intraday_range
        description: "High minus low price"

      - name: intraday_range_pct
        description: "Intraday range as percentage of low price"

      - name: is_suspicious
        description: "Flag for records with unusual price movements (>50% change)"

  - name: stg_indicators
    description: "Cleaned and standardized economic indicators from BCB API"
    columns:
      - name: indicator_code
        description: "Standardized BCB indicator code"
        tests:
          - not_null
          - accepted_values:
              values: ['432', '433', '1', '4389', '24363', '189', '4380']

      - name: indicator_name
        description: "Human-readable indicator name"
        tests:
          - not_null

      - name: date
        description: "Indicator reference date"
        tests:
          - not_null

      - name: value
        description: "Indicator value"
        tests:
          - not_null

      - name: unit
        description: "Unit of measurement"

      - name: frequency
        description: "Data frequency"
